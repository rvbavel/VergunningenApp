<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8" />
  <title>Inboeken Vergunningen</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <header>
    <img src="logo.png" alt="Speciaal Transport Zwolle B.V." class="logo" />
    <h1>Inboeken Vergunningen</h1>
  </header>

  <nav class="top-menu">
    <button onclick="window.location.href='index.html'">üè† HOME</button>
    <button onclick="window.location.href='vergunningen.html'">INBOEKEN VERGUNNINGEN</button>
    <button onclick="window.location.href='ontheffingenrapport.html'">ONTHEFFINGEN RAPPORT</button>
    <button onclick="window.location.href='begeleidingenrapport.html'">BEGELEIDINGEN RAPPORT</button>
    <button onclick="window.location.href='aanvraagtransportbegeleiding.html'">AANVRAAG TRANSPORTBEGELEIDING</button>
  </nav>

  <main class="card">
    <h2>Nieuwe Vergunning Invoeren</h2>

    <form id="vergunningForm">
      <div class="form-row">
        <label>
          Klantnaam:
          <input type="text" id="klantnaam" required />
        </label>
        <label>
          E-mail klant:
          <input type="email" id="emailklant" required />
        </label>
      </div>

      <div class="form-row">
        <label>
          Vergunningsnummer:
          <input type="text" id="vergunningnr" required />
        </label>
        <label>
          Vervaldatum:
          <input type="date" id="vervaldatum" required />
        </label>
      </div>

      <div class="form-row">
        <label>
          Waarschuwingsdrempel (dagen):
          <input type="number" id="drempel" required />
        </label>
        <label>
          Vergunning (PDF):
          <input type="file" id="pdfUpload" accept=".pdf" />
        </label>
      </div>

      <button type="submit" class="primary-btn">Opslaan</button>
    </form>

    <!-- Kolomtitels -->
    <div class="result-head">
      <div class="result-col"><strong>Klantnaam</strong></div>
      <div class="result-col"><strong>Ontheffingsnummer</strong></div>
      <div class="result-col"><strong>Vervaldatum</strong></div>
      <div class="result-col"><strong>Status</strong></div>
      <div class="result-col"><strong>Acties</strong></div>
    </div>

    <div id="vergunningenLijst"></div>
  </main>

  <footer>
    Ontwikkeld door Ren√© van Bavel ¬©2025 Speciaal Transport Zwolle B.V.
  </footer>

<script>
  const form = document.getElementById("vergunningForm");
  const lijst = document.getElementById("vergunningenLijst");

  form.addEventListener("submit", function(e) {
    e.preventDefault();

    const klant = document.getElementById("klantnaam").value;
    const email = document.getElementById("emailklant").value;
    const vergunning = document.getElementById("vergunningnr").value;
    const verval = document.getElementById("vervaldatum").value;
    const drempel = parseInt(document.getElementById("drempel").value);

    const vervalDatum = new Date(verval);
    const vandaag = new Date();
    const verschil = Math.ceil((vervalDatum - vandaag) / (1000 * 60 * 60 * 24));

    let status = "geldig";
    let kleur = "green";
    if (verschil <= 0) {
      status = "vervallen";
      kleur = "red";
    } else if (verschil <= drempel) {
      status = "gaat vervallen";
      kleur = "orange";
    }

    const rij = document.createElement("div");
    rij.classList.add("result-row");

    const datumNL = vervalDatum.toLocaleDateString("nl-NL");

    rij.innerHTML = `
      <div class="result-col">${klant}</div>
      <div class="result-col">${vergunning}</div>
      <div class="result-col">${datumNL}</div>
      <div class="result-col"><span class="status ${kleur}">${status}</span></div>
      <div class="result-col actions">
        <button class="email-btn">Email klant</button>
        <button class="edit-btn">Bewerk</button>
        <button class="delete-btn">Verwijder</button>
      </div>
    `;

    lijst.appendChild(rij);

    rij.querySelector(".email-btn").addEventListener("click", () => {
      const onderwerp = `Betreft: Uw vergunning`;
      const tekst = `Geachte ${klant},%0D%0A%0D%0AWij willen u informeren dat uw vergunning geldig is tot ${datumNL}.%0D%0AGraag houden wij u hiervan op de hoogte.%0D%0A%0D%0AMet vriendelijke groet,%0D%0ASpeciaal Transport Zwolle B.V.`;
      const mailtoLink = `mailto:${email}?subject=${encodeURIComponent(onderwerp)}&body=${tekst}`;
      window.location.href = mailtoLink;
    });

    form.reset();
  });
</script>
</body>
</html>

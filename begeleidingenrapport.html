<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8">
  <title>Speciaal Transport Zwolle B.V. - Begeleidingenrapport</title>
  <link rel="stylesheet" href="style.css">
  <link rel="stylesheet" href="print.css" media="print">
</head>
<body>

<header>
  <img src="logo.png" alt="Speciaal Transport Zwolle B.V." class="logo">
  <h1>BEGELEIDINGENRAPPORT</h1>
</header>
  
   <nav class="top-menu">
    <button onclick="window.location.href='index.html'">üè† HOME</button>
    <button onclick="window.location.href='vergunningen.html'">INBOEKEN VERGUNNINGEN</button>
    <button onclick="window.location.href='ontheffingenrapport.html'">ONTHEFFINGEN RAPPORT</button>
    <button onclick="window.location.href='begeleidingenrapport.html'">BEGELEIDINGEN RAPPORT</button>
    <button onclick="window.location.href='transportbegeleiding.html'">AANVRAAG TRANSPORTBEGELEIDING</button>
  </nav>

<main class="card">
  <h2>BEGELEIDINGEN RAPPORT</h2>

  <div class="form-grid">
    <label>Referentienummer:
      <div class="split-input">
        <span class="prefix">2025.</span>
        <input type="text" id="referentienummer" maxlength="4">
      </div>
    </label>
    <label>Behandelaar:
      <select id="behandelaar">
        <option value="">--- Maak keuze ---</option>
        <option value="Ren√©">Ren√©</option>
        <option value="Anke">Anke</option>
        <option value="Sia">Sia</option>
        <option value="Martijn">Martijn</option>
      </select>
    </label>
  </div>

  <div class="form-grid-three">
    <label>Opdrachtgever:
      <input type="text" id="opdrachtgever">
    </label>
    <label>Vervoerder:
      <input type="text" id="vervoerder">
    </label>
    <label>Referentie klant:
      <input type="text" id="referentie_klant">
    </label>
  </div>

  <div class="form-grid-single">
    <label>Omschrijving:
      <textarea id="omschrijving"></textarea>
    </label>
  </div>

  <div class="form-grid-single">
    <label>Opmerkingen t.a.v. facturatie:
      <textarea id="opmerkingen_facturatie"></textarea>
    </label>
  </div>

  <h3>Details per regel</h3>
  <div class="form-grid-seven">
    <div>
      <label>Begeleidingsfirma:</label>
      <input type="text" value="Bemiddeling STZ"><input><input><input><input><input><input><input>
    </div>
    <div>
      <label>Transportdatum:</label>
      <input type="date"><input type="date"><input type="date"><input type="date">
      <input type="date"><input type="date"><input type="date"><input type="date">
    </div>
    <div>
      <label>Van:</label>
      <input><input><input><input><input><input><input><input>
    </div>
    <div>
      <label>Naar:</label>
      <input><input><input><input><input><input><input><input>
    </div>
    <div>
      <label>Uren:</label>
      <input type="number"><input type="number"><input type="number"><input type="number">
      <input type="number"><input type="number"><input type="number"><input type="number">
    </div>
    <div>
      <label>Inkoopprijs (‚Ç¨):</label>
      <input type="text" data-type="inkoop"><input type="text" data-type="inkoop">
      <input type="text" data-type="inkoop"><input type="text" data-type="inkoop">
      <input type="text" data-type="inkoop"><input type="text" data-type="inkoop">
      <input type="text" data-type="inkoop"><input type="text" data-type="inkoop">
    </div>
    <div>
      <label>Verkoopprijs (‚Ç¨):</label>
      <input type="text" data-type="verkoop"><input type="text" data-type="verkoop">
      <input type="text" data-type="verkoop"><input type="text" data-type="verkoop">
      <input type="text" data-type="verkoop"><input type="text" data-type="verkoop">
      <input type="text" data-type="verkoop"><input type="text" data-type="verkoop">
    </div>
  </div>

  <div class="form-grid-three">
    <label>Inkoopprijs totaal (‚Ç¨):
      <input type="text" id="inkoop_totaal" readonly>
    </label>
    <label>Verkoopprijs totaal (‚Ç¨):
      <input type="text" id="verkoop_totaal" readonly>
    </label>
    <label>Marge (‚Ç¨):
      <input type="text" id="marge" readonly>
    </label>
  </div>

  <button onclick="genereerPDF()" class="primary-btn">üì• DOWNLOAD ALS PDF</button>
</main>

<footer>
  ¬©2025 - Ontwikkeld door Ren√© van Bavel - VMSbeheer.nl
</footer>

<script>
function formatEuro(value) {
  const number = parseFloat(value);
  if (isNaN(number)) return '';
  return number.toFixed(2).replace('.', ',');
}

function parseEuroString(value) {
  return parseFloat(value.replace(',', '.').replace('‚Ç¨', '').trim()) || 0;
}

function updateTotals() {
  const inkoopInputs = document.querySelectorAll('input[data-type="inkoop"]');
  const verkoopInputs = document.querySelectorAll('input[data-type="verkoop"]');
  const begeleidingsInputs = document.querySelectorAll('.form-grid-seven > div:nth-child(1) input');

  let inkoopTotaal = 0;
  let verkoopTotaal = 0;

  inkoopInputs.forEach(input => {
    const bedrag = parseEuroString(input.value);
    if (!isNaN(bedrag)) inkoopTotaal += bedrag;
  });

  verkoopInputs.forEach((input, index) => {
    if (index === 0 && begeleidingsInputs[0]?.value.trim().toLowerCase() === 'bemiddeling stz') {
      verkoopTotaal += 75.00;
    } else {
      const bedrag = parseEuroString(input.value);
      if (!isNaN(bedrag)) verkoopTotaal += bedrag;
    }
  });

  const marge = verkoopTotaal - inkoopTotaal;

  document.getElementById('inkoop_totaal').value = inkoopTotaal ? `‚Ç¨ ${inkoopTotaal.toFixed(2).replace('.', ',')}` : '';
  document.getElementById('verkoop_totaal').value = verkoopTotaal ? `‚Ç¨ ${verkoopTotaal.toFixed(2).replace('.', ',')}` : '';
  document.getElementById('marge').value = marge ? `‚Ç¨ ${marge.toFixed(2).replace('.', ',')}` : '';
}

document.addEventListener('DOMContentLoaded', () => {
  const begeleidingsInputs = document.querySelectorAll('.form-grid-seven > div:nth-child(1) input');
  const urenInputs = document.querySelectorAll('.form-grid-seven > div:nth-child(5) input');
  const verkoopInputs = document.querySelectorAll('input[data-type="verkoop"]');
  const inkoopInputs = document.querySelectorAll('input[data-type="inkoop"]');

  // Regel 1: Bemiddeling STZ = vaste verkoopprijs 75,00
  if (begeleidingsInputs[0] && verkoopInputs[0]) {
    if (begeleidingsInputs[0].value.trim().toLowerCase() === 'bemiddeling stz') {
      verkoopInputs[0].value = '75,00';
    }
    begeleidingsInputs[0].addEventListener('input', () => {
      if (begeleidingsInputs[0].value.trim().toLowerCase() === 'bemiddeling stz') {
        verkoopInputs[0].value = '75,00';
        updateTotals();
      }
    });
  }

  // Berekening verkoopprijs via uren
  urenInputs.forEach((input, index) => {
    input.addEventListener('input', () => {
      const uren = parseFloat(input.value);
      if (!isNaN(uren)) {
        if (!(index === 0 && begeleidingsInputs[0].value.trim().toLowerCase() === 'bemiddeling stz')) {
          verkoopInputs[index].value = (uren * 62.5).toFixed(2).replace('.', ',');
        }
        updateTotals();
      }
    });
  });

  [...inkoopInputs, ...verkoopInputs].forEach(input => {
    input.addEventListener('blur', () => {
      const raw = input.value.trim();
      if (raw === '') {
        input.value = '';
        updateTotals();
        return;
      }
      const bedrag = parseEuroString(input.value);
      if (!isNaN(bedrag)) input.value = formatEuro(bedrag);
      updateTotals();
    });

    input.addEventListener('focus', () => {
      if (input.value === '0,00') input.value = '';
    });
  });

  updateTotals();
});
</script>



</body>
</html>
